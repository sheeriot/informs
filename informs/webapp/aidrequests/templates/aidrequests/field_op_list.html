{% extends "base.html" %}
{% load static %}
{% load bootstrap_icons %}

{% block content %}
<div class="container-fluid px-4 py-3">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="mb-0">
                    <i class="bi bi-truck me-2"></i>Field Operations
                </h2>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Field Ops Table -->
        <div class="col-12">
            {% include "aidrequests/includes/field_ops_table.html" %}
        </div>

        <!-- Map -->
        <div class="col-12">
            {% include "aidrequests/includes/field_ops_map.html" %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<!-- Azure Maps CSS -->
<link href="https://atlas.microsoft.com/sdk/javascript/mapcontrol/3/atlas.min.css" rel="stylesheet" />
{% endblock %}

{% block extra_js %}
<!-- Azure Maps JavaScript -->
<script src="https://atlas.microsoft.com/sdk/javascript/mapcontrol/3/atlas.min.js"></script>
<!-- Initialize map -->
<script src="{% static 'js/map_init.js' %}?v={{static_version}}"></script>
<script src="{% static 'js/map_fieldops.js' %}?v={{static_version}}"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const fieldOpsData = JSON.parse(document.getElementById('field-ops-data').textContent);
        initFieldOpsMap(fieldOpsData);
    });
</script>
{% endblock %}
